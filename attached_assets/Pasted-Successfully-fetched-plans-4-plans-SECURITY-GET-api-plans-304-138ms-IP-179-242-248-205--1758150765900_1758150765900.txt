Successfully fetched plans: 4 plans
🔒 [SECURITY] GET /api/plans 304 - 138ms - IP: 179.242.248.205, 10.83.0.29
GET /api/plans 304 in 138ms :: [{"id":"ec994283-76de-4605-afa3-0670a8a0a475","n…
🛒 [CHECKOUT-STEP2] Iniciando salvamento dos dados do cliente e pets
Query: select "id", "full_name", "email", "phone", "cpf", "cep", "address", "number", "complement", "district", "state", "city", "password", "created_at", "updated_at" from "clients" where "clients"."email" = $1 limit $2 -- params: ["contatogabrielmarquez@gmail.com", 1]
🔌 Conexão adquirida do pool
🔌 Conexão liberada de volta ao pool
🏗️ [CHECKOUT-STEP2] Criando cliente: contatogabrielmarquez@gmail.com
Query: insert into "clients" ("id", "full_name", "email", "phone", "cpf", "cep", "address", "number", "complement", "district", "state", "city", "password", "created_at", "updated_at") values ($1, $2, $3, $4, $5, default, default, default, default, default, default, default, $6, default, default) returning "id", "full_name", "email", "phone", "cpf", "cep", "address", "number", "complement", "district", "state", "city", "password", "created_at", "updated_at" -- params: ["client-1758150742705-xqpir9j16", "teste", "contatogabrielmarquez@gmail.com", "12974041539", "", "$2a$12$P07Wfb9imU78TAbnZUKzb.gy5Prp5YGB38mpxRLH4ASjsuLgeoHLi"]
🔌 Conexão adquirida do pool
🔌 Conexão liberada de volta ao pool
🐕 [CHECKOUT-STEP2] Criando pet: teste
Query: insert into "pets" ("id", "client_id", "name", "species", "breed", "age", "weight", "is_active", "created_at", "updated_at") values (default, $1, $2, $3, $4, $5, $6, $7, default, default) returning "id", "client_id", "name", "species", "breed", "age", "weight", "is_active", "created_at", "updated_at" -- params: ["client-1758150742705-xqpir9j16", "teste", "dog", "teste", 1, "1", true]
🔌 Conexão adquirida do pool
🔌 Conexão liberada de volta ao pool
❌ [CHECKOUT-STEP2] Erro ao salvar dados: error: null value in column "sex" of relation "pets" violates not-null constraint
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:65:19)
    at DatabaseStorage.createPet (/home/runner/workspace/server/storage.ts:1017:22)
    at <anonymous> (/home/runner/workspace/server/routes.ts:1178:26) {
  length: 413,
  severity: 'ERROR',
  code: '23502',
  detail: 'Failing row contains (af99dc2b-33c2-4aad-8968-a5eb42b5c142, client-1758150742705-xqpir9j16, teste, dog, teste, null, 1, null, f, null, 1, null, null, null, null, null, null, [], null, null, null, 2025-09-17 23:12:22.919873, 2025-09-17 23:12:22.919873, t).',
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: 'public',
  table: 'pets',
  column: 'sex',
  dataType: undefined,
  constraint: undefined,
  file: 'execMain.c',
  line: '1982',
  routine: 'ExecConstraints'
}
🔒 [SECURITY] POST /api/checkout/save-customer-data 500 - 819ms - IP: 179.242.248.205, 10.83.0.29
POST /api/checkout/save-customer-data 500 in 809ms :: {"error":"Erro interno do…
🔌 Conexão removida do pool
🔌 Conexão adquirida do pool
🔌 Conexão liberada de volta ao pool