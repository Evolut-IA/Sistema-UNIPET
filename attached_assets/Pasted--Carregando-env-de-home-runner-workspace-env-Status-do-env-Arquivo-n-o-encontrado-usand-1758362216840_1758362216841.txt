ðŸ” Carregando .env de: /home/runner/workspace/.env
ðŸ“„ Status do .env: Arquivo nÃ£o encontrado (usando variÃ¡veis de ambiente do sistema)
ðŸ” VariÃ¡veis de ambiente carregadas:
   LOGIN: âœ… Presente
   SENHA: âœ… Presente
   DATABASE_URL: âœ… Presente
   NODE_ENV: undefined
âš ï¸ CIELO_WEBHOOK_SECRET nÃ£o configurado - webhook validation desabilitada (desenvolvimento apenas)
âœ… Todas as configuraÃ§Ãµes obrigatÃ³rias estÃ£o presentes
ðŸ”’ ValidaÃ§Ã£o de seguranÃ§a concluÃ­da com sucesso

ðŸš€ CONFIGURAÃ‡ÃƒO AUTOMÃTICA APLICADA:
=====================================
ðŸŒ Ambiente: development
ðŸ”Œ Porta: 3000
ðŸ  Host: 0.0.0.0
ðŸ’¾ Armazenamento: local
ðŸ”‘ SessÃ£o: Configurada
ðŸ“ž Contato: Configurado via ambiente/banco
=====================================

ðŸ”— Conectando ao Supabase Storage: https://tkzzxsbwkgcdmcreducm.supabase.co
Database URL configured: Yes
Testing database connection...
Attempting to connect to: postgresql://***:***@aws-1-sa-east-1.pooler.supabase.com:6543/postgres
ðŸš€ Inicializando servidor unificado UNIPET + Admin...
ðŸ”Œ Inicializando banco de dados...
ðŸ”Œ Inicializando conexÃ£o com banco de dados...
PostgreSQL parameter: DateStyle = ISO, MDY
PostgreSQL parameter: IntervalStyle = postgres
PostgreSQL parameter: TimeZone = UTC
PostgreSQL parameter: application_name = Supavisor
PostgreSQL parameter: client_encoding = UTF8
PostgreSQL parameter: default_transaction_read_only = off
PostgreSQL parameter: in_hot_standby = off
PostgreSQL parameter: integer_datetimes = on
PostgreSQL parameter: is_superuser = off
PostgreSQL parameter: scram_iterations = 4096
PostgreSQL parameter: server_encoding = UTF8
PostgreSQL parameter: server_version = 17.4
PostgreSQL parameter: session_authorization = postgres
PostgreSQL parameter: standard_conforming_strings = on
âœ… ConexÃ£o com banco de dados estabelecida com sucesso
ðŸ“Š Pool configurado com 20 conexÃµes mÃ¡ximas
âœ… Banco de dados inicializado com sucesso
ðŸ›£ï¸ Registrando rotas do UNIPET (/api/*)...
ðŸ“ [STATIC-FILES] Static file serving disabled - using Supabase Storage
âœ… Rotas do UNIPET registradas
ðŸ”§ Registrando rotas do ADMIN (/admin/api/*)...
ðŸ”§ Admin APIs em desenvolvimento: serÃ¡ usado proxy em /admin/api/*
ðŸ”§ Configurando proxy para sistema Admin (desenvolvimento)...
âœ… Proxy do Admin configurado para desenvolvimento
ðŸ“ Configurando arquivos estÃ¡ticos...
âœ… Arquivos estÃ¡ticos configurados (UNIPET sempre servido)
ðŸ›¡ï¸ Configurando tratamento de erros...

ðŸŽ‰ SERVIDOR UNIFICADO INICIADO COM SUCESSO!
==========================================
ðŸŒ URL: http://0.0.0.0:5000
ðŸ  Host: 0.0.0.0 (Aceita conexÃµes externas)
ðŸŒ Ambiente: development
ðŸ“ DiretÃ³rio: /home/runner/workspace
ðŸ”Œ Banco: Conectado e saudÃ¡vel

ðŸ“‹ SERVIÃ‡OS DISPONÃVEIS:
  ðŸ¦„ UNIPET:
    â€¢ Frontend: / (raiz)
    â€¢ APIs: /api/*
    â€¢ Health: /api/health
  ðŸ”§ ADMIN:
    â€¢ Frontend: /admin
    â€¢ APIs: /admin/api/*
    â€¢ Health: /admin/health

ðŸ”’ FUNCIONALIDADES:
  â€¢ Roteamento unificado
  â€¢ Banco de dados compartilhado
  â€¢ Sessions e cookies configurados
  â€¢ Tratamento de erros global
  â€¢ Admin com Hot Reload (Vite)
  â€¢ UNIPET frontend externo (recomendado)
==========================================

Database connection successful!

> rest-express@1.0.0 dev
> cross-env NODE_ENV=development tsx server/index.ts

Site settings table exists: true
whatsapp column exists: true
email column exists: true
phone column exists: true
instagram_url column exists: true
facebook_url column exists: true
linkedin_url column exists: true
youtube_url column exists: true
cnpj column exists: true
business_hours column exists: true
our_story column exists: true
privacy_policy column exists: true
terms_of_use column exists: true
address column exists: true
Query: select "id", "whatsapp", "email", "phone", "instagram_url", "facebook_url", "linkedin_url", "youtube_url", "cnpj", "business_hours", "our_story", "created_at", "updated_at", "privacy_policy", "terms_of_use", "address", "main_image", "network_image", "about_image", "main_image_url", "network_image_url", "about_image_url", "cores" from "site_settings" limit $1 -- params: [1]
main_image column exists: true
Query: select "id", "name", "price", "description", "features", "image", "button_text", "plan_type", "is_active", "display_order", "created_at", "billing_frequency", "base_price", "installment_price", "installment_count", "per_pet_billing", "pet_discounts", "payment_description", "available_payment_methods", "available_billing_options", "annual_price", "annual_installment_price", "annual_installment_count" from "plans" where "plans"."is_active" = $1 order by "plans"."display_order" asc -- params: [true]
Database URL configured: Yes
Testing database connection...
Attempting to connect to: postgresql://***:***@aws-1-sa-east-1.pooler.supabase.com:6543/postgres
network_image column exists: true
GET /api/site-settings 200 in 276ms :: {"id":"19c61b78-d8a3-4b26-a289-7b71e8785â€¦
9:53:50 AM [express] serving on port 3002
about_image column exists: true
Query: select "id", "question", "answer", "display_order", "is_active", "created_at" from "faq_items" where "faq_items"."is_active" = $1 order by "faq_items"."display_order" asc -- params: [true]
Query: select "id", "welcome_message", "placeholder_text", "chat_title", "button_icon", "bot_icon", "user_icon", "bot_icon_url", "user_icon_url", "chat_position", "chat_size", "is_enabled", "created_at", "updated_at" from "chat_settings" limit $1 -- params: [1]
cores column exists: true
GET /api/faq 200 in 137ms :: [{"id":"5cb21830-8d80-4ad0-9ef3-7117393dfb53","queâ€¦
GET /api/plans 200 in 664ms :: [{"id":"ec994283-76de-4605-afa3-0670a8a0a475","nâ€¦
âœ… [CHAT] Chat settings retrieved: {
  hasBotIcon: true,
  hasUserIcon: true,
  botIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>,
  userIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>
}
GET /api/chat/settings 200 in 803ms :: {"id":"77d0d663-ecc3-48a8-8100-c6c6a39cdâ€¦
PostgreSQL parameter: DateStyle = ISO, MDY
PostgreSQL parameter: IntervalStyle = postgres
PostgreSQL parameter: TimeZone = UTC
PostgreSQL parameter: application_name = Supavisor
PostgreSQL parameter: client_encoding = UTF8
PostgreSQL parameter: default_transaction_read_only = off
PostgreSQL parameter: in_hot_standby = off
PostgreSQL parameter: integer_datetimes = on
PostgreSQL parameter: is_superuser = off
PostgreSQL parameter: scram_iterations = 4096
PostgreSQL parameter: server_encoding = UTF8
PostgreSQL parameter: server_version = 17.4
PostgreSQL parameter: session_authorization = postgres
PostgreSQL parameter: standard_conforming_strings = on
Database connection successful!
Site settings table exists: true
whatsapp column exists: true
email column exists: true
phone column exists: true
instagram_url column exists: true
facebook_url column exists: true
linkedin_url column exists: true
youtube_url column exists: true
cnpj column exists: true
business_hours column exists: true
our_story column exists: true
privacy_policy column exists: true
terms_of_use column exists: true
address column exists: true
main_image column exists: true
network_image column exists: true
about_image column exists: true
cores column exists: true
Query: select "id", "whatsapp", "email", "phone", "instagram_url", "facebook_url", "linkedin_url", "youtube_url", "cnpj", "business_hours", "our_story", "created_at", "updated_at", "privacy_policy", "terms_of_use", "address", "main_image", "network_image", "about_image", "main_image_url", "network_image_url", "about_image_url", "cores" from "site_settings" limit $1 -- params: [1]
Query: select "id", "name", "price", "description", "features", "image", "button_text", "plan_type", "is_active", "display_order", "created_at", "billing_frequency", "base_price", "installment_price", "installment_count", "per_pet_billing", "pet_discounts", "payment_description", "available_payment_methods", "available_billing_options", "annual_price", "annual_installment_price", "annual_installment_count" from "plans" where "plans"."is_active" = $1 order by "plans"."display_order" asc -- params: [true]
Query: select "id", "question", "answer", "display_order", "is_active", "created_at" from "faq_items" where "faq_items"."is_active" = $1 order by "faq_items"."display_order" asc -- params: [true]
Query: select "id", "welcome_message", "placeholder_text", "chat_title", "button_icon", "bot_icon", "user_icon", "bot_icon_url", "user_icon_url", "chat_position", "chat_size", "is_enabled", "created_at", "updated_at" from "chat_settings" limit $1 -- params: [1]
GET /api/faq 200 in 162ms :: [{"id":"5cb21830-8d80-4ad0-9ef3-7117393dfb53","queâ€¦
GET /api/plans 200 in 182ms :: [{"id":"ec994283-76de-4605-afa3-0670a8a0a475","nâ€¦
GET /api/site-settings 200 in 267ms :: {"id":"19c61b78-d8a3-4b26-a289-7b71e8785â€¦
âœ… [CHAT] Chat settings retrieved: {
  hasBotIcon: true,
  hasUserIcon: true,
  botIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>,
  userIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>
}
GET /api/chat/settings 200 in 790ms :: {"id":"77d0d663-ecc3-48a8-8100-c6c6a39cdâ€¦
Query: select "id", "whatsapp", "email", "phone", "instagram_url", "facebook_url", "linkedin_url", "youtube_url", "cnpj", "business_hours", "our_story", "created_at", "updated_at", "privacy_policy", "terms_of_use", "address", "main_image", "network_image", "about_image", "main_image_url", "network_image_url", "about_image_url", "cores" from "site_settings" limit $1 -- params: [1]
Query: select "id", "welcome_message", "placeholder_text", "chat_title", "button_icon", "bot_icon", "user_icon", "bot_icon_url", "user_icon_url", "chat_position", "chat_size", "is_enabled", "created_at", "updated_at" from "chat_settings" limit $1 -- params: [1]
Query: select "id", "name", "price", "description", "features", "image", "button_text", "plan_type", "is_active", "display_order", "created_at", "billing_frequency", "base_price", "installment_price", "installment_count", "per_pet_billing", "pet_discounts", "payment_description", "available_payment_methods", "available_billing_options", "annual_price", "annual_installment_price", "annual_installment_count" from "plans" where "plans"."is_active" = $1 order by "plans"."display_order" asc -- params: [true]
Query: select "id", "question", "answer", "display_order", "is_active", "created_at" from "faq_items" where "faq_items"."is_active" = $1 order by "faq_items"."display_order" asc -- params: [true]
GET /api/plans 304 in 136ms :: [{"id":"ec994283-76de-4605-afa3-0670a8a0a475","nâ€¦
GET /api/faq 304 in 147ms :: [{"id":"5cb21830-8d80-4ad0-9ef3-7117393dfb53","queâ€¦
âœ… [CHAT] Chat settings retrieved: {
  hasBotIcon: true,
  hasUserIcon: true,
  botIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>,
  userIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>
}
GET /api/chat/settings 304 in 261ms :: {"id":"77d0d663-ecc3-48a8-8100-c6c6a39cdâ€¦
GET /api/site-settings 200 in 272ms :: {"id":"19c61b78-d8a3-4b26-a289-7b71e8785â€¦
Query: select "id", "whatsapp", "email", "phone", "instagram_url", "facebook_url", "linkedin_url", "youtube_url", "cnpj", "business_hours", "our_story", "created_at", "updated_at", "privacy_policy", "terms_of_use", "address", "main_image", "network_image", "about_image", "main_image_url", "network_image_url", "about_image_url", "cores" from "site_settings" limit $1 -- params: [1]
Query: select "id", "name", "address", "phone", "services", "image_url", "is_active", "created_at", "whatsapp", "google_maps_url", "image_data", "url_slug", "login", "senha_hash" from "network_units" where "network_units"."is_active" = $1 -- params: [true]
GET /api/site-settings 200 in 273ms :: {"id":"19c61b78-d8a3-4b26-a289-7b71e8785â€¦
GET /api/network-units 200 in 350ms :: [{"id":"9fa00ec6-8895-4f83-ada8-0e80a1c8â€¦
Query: select "id", "welcome_message", "placeholder_text", "chat_title", "button_icon", "bot_icon", "user_icon", "bot_icon_url", "user_icon_url", "chat_position", "chat_size", "is_enabled", "created_at", "updated_at" from "chat_settings" limit $1 -- params: [1]
âœ… [CHAT] Chat settings retrieved: {
  hasBotIcon: true,
  hasUserIcon: true,
  botIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>,
  userIconUrl: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 40 00 00 00 2c 08 03 00 00 00 e2 81 4e cd 00 00 03 00 50 4c 54 45 fd fd fd f5 f4 f5 50 93 31 ... 3453 more bytes>
}
GET /api/chat/settings 304 in 263ms :: {"id":"77d0d663-ecc3-48a8-8100-c6c6a39cdâ€¦